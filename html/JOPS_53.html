<div class="container">

<table style="width: 100%;"><tr>
<td>psNormal_Deriv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derivative for a P-spline fit of scattered (normal)
data.</h2>

<h3>Description</h3>

<p><code>psNormal_Deriv</code> provides the derivative
P-spline fit along <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psNormal_Deriv(
  x,
  y,
  xl = min(x),
  xr = max(x),
  nseg = 10,
  bdeg = 3,
  pord = 2,
  lambda = 1,
  wts = rep(1, length(y)),
  xgrid = x
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the vector for the continuous regressor of <code>length(y)</code> and the abcissae of fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response vector, usually continuous data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl</code></td>
<td>
<p>the number for the min along <code>x</code> (default is min(<code>x</code>)) .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xr</code></td>
<td>
<p>the number for the max along <code>x</code> (default is max(<code>x</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of evenly spaced segments between <code>xl</code> and <code>xr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdeg</code></td>
<td>
<p>the number of the degree of the basis, usually 1, 2, or 3 (defalult).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>the number of the order of the difference penalty, usually 1, 2 (defalult), or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the positive tuning parameter (default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>the vector of weights, default is 1; 0/1 allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>a scalar or a vector that gives the <code>x</code> locations for prediction, useful for plotting.
If a scalar (default 100) is used then a uniform grid of this size along (<code>xl</code>, <code>xr</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is also a
support function needed for <code>sim_psr</code> and <code>sim_vcpsr</code>.
SISR (Eilers, Li, Marx, 2009).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a vector of <code>length(nsegs + bdeg)</code>
of estimated P-spline coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The B-spline matrix of dimensions <code>m</code> by <code>length(coef)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a vector of <code>length(y)</code> of smooth estimated means (at the <code>x</code> locations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>a vector of <code>length(xgrid)</code> of (future) predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_coef</code></td>
<td>
<p>a vector of <code>length(nsegs + bdeg - 1)</code>
of differenced (derivative) estimated P-spline coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_d</code></td>
<td>
<p>The first derivative B-spline matrix of dimensions <code>m</code> by <code>lengh(d_coef)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_fit</code></td>
<td>
<p>a vector of <code>length(y)</code> of partial derivative (along <code>x</code>)
of the smooth estimated means (at the <code>x</code> locations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_pred</code></td>
<td>
<p>a vector of length <code>lenght(xgrid)</code> of partial derivative (future) predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl</code></td>
<td>
<p>the number for the min along <code>x</code> (default is min(<code>x</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xr</code></td>
<td>
<p>the number for the max along <code>x</code> (default is max(<code>x</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of evenly spaced segments between <code>xl</code> and <code>xr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdeg</code></td>
<td>
<p>the number of the degree of the basis, usually 1, 2, or 3 (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>the number of the order of the difference penalty, usually 1, 2 (default), or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the positive tuning parameter (default 1).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Paul Eilers and Brian Marx
</p>


<h3>References</h3>

<p>Marx, B. D. (2015). Varying-coefficient single-index signal
regression. <em>Chemometrics and Intelligent Laboratory Systems</em>, 143, 111â€“121.
</p>
<p>Eilers, P.H.C., B. Li, B.D. Marx (2009).
Multivariate calibration with single-index signal regression,
<em>Chemometrics and Intellegent Laboratory Systems</em>, 96(2), 196-202.
</p>
<p>Eilers, P.H.C. and Marx, B.D. (2021). <em>Practical Smoothing, The Joys of
P-splines.</em> Cambridge University Press.
</p>


<h3>See Also</h3>

<p>sim_psr sim_vcpsr
</p>


</div>