<div class="container">

<table style="width: 100%;"><tr>
<td>psPoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smoothing scattered Poisson data using P-splines.</h2>

<h3>Description</h3>

<p><code>psPoisson</code> is used to smooth scattered
Poisson data using P-splines with a log link function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psPoisson(
  x,
  y,
  xl = min(x),
  xr = max(x),
  nseg = 10,
  bdeg = 3,
  pord = 2,
  lambda = 1,
  wts = NULL,
  show = FALSE,
  iter = 100,
  xgrid = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the vector for the continuous regressor of <code>length(y)</code> and
the abcissae used to build the B-spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response vector, usually count data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl</code></td>
<td>
<p>the number for the min along <code>x</code> (default is min(<code>x</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xr</code></td>
<td>
<p>the number for the max along <code>x</code> (default is max(<code>x</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of evenly spaced segments between <code>xl</code> and <code>xr</code> (default 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdeg</code></td>
<td>
<p>the number of the degree of the basis, usually 1, 2, or 3 (defalult).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>the number of the order of the difference penalty, usually 1, 2 (default), or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the (positive) number for the tuning parameter for the penalty (default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>the vector of general weights, zeros are allowed (default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>Set to TRUE or FALSE to display iteration history (default FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>a scalar to set the maximum number of iterations, default <code>iter=100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>a scalar or a vector that gives the <code>x</code> locations for prediction, useful for plotting.
If a scalar (default 100) is used then a uniform grid of this size along (<code>xl</code>, <code>xr</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pcoef</code></td>
<td>
<p>a vector of length <code>n</code> of estimated P-spline coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>a vector of length <code>m</code> of estimated means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the <code>m</code> by <code>n</code> B-spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>
<p>deviance of fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effdim</code></td>
<td>
<p>effective dimension of fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>the vector of given prior weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of B-spline segments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdeg</code></td>
<td>
<p>the degree of the B-spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>the order of the difference penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the positive tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family of the response (
<code>"Poisson"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the link function used (<code>"log"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>gridded x values, useful for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ygrid</code></td>
<td>
<p>gridded fitted linear predictor values, useful for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mugrid</code></td>
<td>
<p>gridded (inverse link) fitted mean values, useful for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_eta</code></td>
<td>
<p>gridded standard errors for the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>Dispersion parameter estimated <code>dev/(m-effdim)</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Paul Eilers and Brian Marx
</p>


<h3>References</h3>

<p>Eilers, P.H.C. and Marx, B.D. (2021). <em>Practical Smoothing, The Joys of
P-splines.</em> Cambridge University Press.
</p>
<p>Eilers, P.H.C., Marx, B.D., and Durban, M. (2015).
Twenty years of P-splines, <em>SORT</em>, 39(2): 149-186.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(JOPS)
library(boot)

# Extract the data
Count &lt;- hist(boot::coal$date, breaks = c(1851:1963), plot = FALSE)$counts
Year &lt;- c(1851:1962)
xl &lt;- min(Year)
xr &lt;- max(Year)

# Poisson smoothing
nseg &lt;- 20
bdeg &lt;- 3
fit1 &lt;- psPoisson(Year, Count, xl, xr, nseg, bdeg, pord = 2, lambda = 1)
plot(fit1, xlab = "Year", ylab = "Count", se = 2)
</code></pre>


</div>